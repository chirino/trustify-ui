"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[567],{24813:(e,t,l)=>{l.d(t,{A:()=>b});var a=l(1180),r=l(28341),n=l(73401),i=l(64335),s=l(57311),o=l(73220),c=l(99205),d=l(68986),m=l(33364),u=l(94279),p=l(16172),E=l(63696),v=l(56279),g=l(84608),f=l(341),y=l(77307);const b=({isExpanded:e,uploads:t,onCloseClick:l,handleUpload:b,handleRemoveUpload:h,extractSuccessMessage:C,extractErrorMessage:x})=>{const[T,w]=E.useState(!1),[S,P]=E.useState("inProgress"),[k,I]=E.useState([]);!T&&t.size>0&&w(!0),E.useEffect((()=>{const e=Array.from(t.values());e.some((e=>"inProgress"===e.status))?P("inProgress"):e.every((e=>"complete"===e.status))?P("success"):P("danger")}),[t]);const K=Array.from(t.values()).filter((e=>e.response)).length;return E.createElement(y.q,{isExpanded:e,onCloseClick:l,pageKey:"upload-files",drawerPanelContentProps:{defaultSize:"600px"},header:E.createElement(a.n,null,E.createElement(r.h,{headingLevel:"h2",size:"lg",className:f.A.mtXs},"Upload files"))},E.createElement(n.w,{onFileDrop:(e,t)=>{b(t)},dropzoneProps:{accept:{"application/xml":[".json"]},onDropRejected:e=>{I(e)}},isHorizontal:!0},E.createElement(i.x,{titleIcon:E.createElement(g.Ay,null),titleText:"Drag and drop files here",titleTextSeparator:"or",infoText:"Accepted file types: JSON"}),T&&E.createElement(s.y,{statusToggleText:`${K} of ${t.size} files uploaded`,statusToggleIcon:S},Array.from(t.entries()).map((([e,t],l)=>E.createElement(o.L,{fileIcon:E.createElement(v.Ay,null),file:e,key:`${e.name}-${l}`,onClearClick:()=>{[e].forEach((e=>{h(e)}))},progressValue:t.progress,progressVariant:t.error?"danger":t.response?"success":void 0,progressHelperText:t.error?E.createElement(c.E,{isLiveRegion:!0},E.createElement(d.j,{variant:"error"},x(t.error))):t.response?E.createElement(c.E,{isLiveRegion:!0},E.createElement(d.j,{variant:"default"},C(t.response))):void 0})))),E.createElement(m.a,{isOpen:k.length>0,title:"Unsupported files",titleIconVariant:"warning",showClose:!0,"aria-label":"unsupported file upload attempted",onClose:()=>I([]),variant:"small"},E.createElement(u.B8,null,k.map(((e,t)=>E.createElement(p.c,{key:t},e.file.name)))))))}},63195:(e,t,l)=>{l.r(t),l.d(t,{default:()=>Q});var a=l(63696),r=l(49348),n=l(68430),i=l(1180),s=l(72785),o=l(20653),c=l(35048),d=l(4433),m=l(77635),u=l(38914),p=l(57901),E=l(76072),v=l(97299),g=l(17327),f=l(64361),y=l(71603),b=l(33364),h=l(85578),C=l(16646),x=l(31065),T=l(77819),w=l(28516),S=l(3629),P=l(62101),k=l(38139),I=l(86820),K=l(33273),A=l(1349),N=l(62520),F=l(24813),L=l(70611),U=l(23713),Z=l(5098),_=l(69935),R=l(67837),$=l(52302),M=l(85278),j=l(50705),V=l(81997),z=l(80254),H=l(88112),O=l(32343),D=l(28338),B=l(70045),G=l(9369),J=l(55399),W=l(86099);const X=({severities:e})=>{const t=Object.values(e).reduce(((e,t)=>e+t),0);return a.createElement(D.s,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},a.createElement(B.Z,{style:{minWidth:15,textAlign:W.pG}},t),a.createElement(G.c,{orientation:{default:"vertical"}}),a.createElement(B.Z,null,a.createElement(D.s,null,Object.entries(e).filter((([e,t])=>t>0)).sort((0,J.S)((([e,t])=>e))).reverse().map((([e,t],l)=>a.createElement(B.Z,{key:l,spacer:{default:"spacerXs"}},a.createElement(D.s,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},a.createElement(B.Z,null,a.createElement($.h,{value:e,hideLabel:!0})),a.createElement(B.Z,null,t))))))))},q={none:0,low:0,medium:0,high:0,critical:0},Y=({vulnerabilities:e})=>{const t=e.reduce(((e,t)=>({...e,[t.severity]:e[t.severity]+1})),q);return a.createElement(X,{severities:t})},Q=()=>{const{pushNotification:e}=a.useContext(j.K),[t,l]=a.useState(!1),{uploads:D,handleUpload:B,handleRemoveUpload:G}=(0,_.Yu)(),[J,W]=a.useState(null),[X,q]=a.useState(null),Q=(e,t)=>{W(e),q(t)},{mutate:ee}=(0,_.uJ)((()=>{}),(t=>{e({title:"Error while updating labels",variant:"danger"})})),te=(0,L.MM)({tableName:"advisories",persistenceKeyPrefix:I.rt.advisories,columnNames:{identifier:"Identifier",title:"Title",severity:"Severity",labels:"Labels",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["identifier","severity"],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:K.RJ.search},{categoryKey:"average_severity",title:"Severity",placeholderText:"Severity",type:K.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:le,total:ae},isFetching:re,fetchError:ne}=(0,_.VH)((0,L.Ng)({...te,hubSortFieldKeys:{identifier:"identifier",severity:"average_score"}})),ie=(0,L.PB)({...te,idProperty:"uuid",currentPageItems:le,totalItemCount:ae,isLoading:re,selectionState:(0,Z.$)({items:le,isEqual:(e,t)=>e.identifier===t.identifier})}),{numRenderedColumns:se,currentPageItems:oe,propHelpers:{toolbarProps:ce,filterToolbarProps:de,paginationToolbarItemProps:me,paginationProps:ue,tableProps:pe,getThProps:Ee,getTrProps:ve,getTdProps:ge,getExpandedContentTdProps:fe},expansionDerivedState:{isCellExpanded:ye}}=ie,{downloadAdvisory:be}=(0,U.m)();return a.createElement(a.Fragment,null,a.createElement(n.d8,{variant:n.zC.light},a.createElement(i.n,null,a.createElement(s.E,{component:"h1"},"Advisories"))),a.createElement(n.d8,null,a.createElement("div",{style:{backgroundColor:"var(--pf-v5-global--BackgroundColor--100)"}},a.createElement(o.M,{...ce},a.createElement(c.P,null,a.createElement(K.Us,{showFiltersSideBySide:!0,...de}),a.createElement(d.T,null,a.createElement(m.$n,{type:"button",id:"upload","aria-label":"Upload",variant:"secondary",onClick:()=>l(!0)},"Upload")),a.createElement(d.T,{...me},a.createElement(A.n,{idPrefix:"advisory-table",isTop:!0,paginationProps:ue})))),a.createElement(h.X,{...pe,"aria-label":"Advisory table",className:"vertical-middle-aligned-table"},a.createElement(C.d,null,a.createElement(x.Tr,null,a.createElement(N.Ze,{...ie},a.createElement(T.Th,{...Ee({columnKey:"identifier"})}),a.createElement(T.Th,{...Ee({columnKey:"title"})}),a.createElement(T.Th,{...Ee({columnKey:"severity"})}),a.createElement(T.Th,{...Ee({columnKey:"labels"})}),a.createElement(T.Th,{...Ee({columnKey:"vulnerabilities"})})))),a.createElement(N.nJ,{isLoading:re,isError:!!ne,isNoData:0===ae,numRenderedColumns:se},oe.map(((e,t)=>a.createElement(w.N,{key:e.identifier,isExpanded:ye(e)},a.createElement(x.Tr,{...ve({item:e})},a.createElement(N.Oi,{...ie,item:e,rowIndex:t},a.createElement(S.Td,{width:15,...ge({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:t})},a.createElement(r.k2,{to:`/advisories/${e.uuid}`},e.identifier)),a.createElement(S.Td,{width:40,modifier:"breakWord",...ge({columnKey:"title"})},e.title),a.createElement(S.Td,{width:10,modifier:"truncate",...ge({columnKey:"severity"})},e.average_severity&&a.createElement($.h,{value:e.average_severity})),a.createElement(S.Td,{width:25,modifier:"truncate",...ge({columnKey:"labels"})},e.labels&&a.createElement(R.g,{value:e.labels})),a.createElement(S.Td,{width:10,modifier:"truncate",...ge({columnKey:"vulnerabilities",isCompoundExpandToggle:!0,item:e,rowIndex:t})},e.vulnerabilities&&a.createElement(Y,{vulnerabilities:e.vulnerabilities})),a.createElement(S.Td,{isActionCell:!0},a.createElement(P.G,{items:[{title:"Edit labels",onClick:()=>{Q("editLabels",e)}},{title:"View source",onClick:()=>{Q("viewSource",e)}},{title:"Download",onClick:()=>{be(e.uuid,`${e.identifier}.json`)}}]})))),ye(e)?a.createElement(x.Tr,{isExpanded:!0},a.createElement(S.Td,{...fe({item:e})},a.createElement(k.g,null,a.createElement("div",{className:"pf-v5-u-m-md"},ye(e,"identifier")?a.createElement(a.Fragment,null,a.createElement(u.B,{hasGutter:!0},a.createElement(p.a,null,a.createElement(E.x,{hasGutter:!0},a.createElement(v.E,{md:6},a.createElement(g.Z,{isFullHeight:!0,isCompact:!0},a.createElement(f.Z,null,"General view"),a.createElement(y.b,null,a.createElement(z.V,{advisory:e,excludedFields:["title"],descriptionListProps:{columnModifier:{default:"2Col"}}})))),a.createElement(v.E,{md:6},a.createElement(g.Z,{isFullHeight:!0,isCompact:!0},a.createElement(f.Z,null,"Issuer"),a.createElement(y.b,null,a.createElement(H.N,{value:e})))))))):null,ye(e,"vulnerabilities")?a.createElement(a.Fragment,null,e.vulnerabilities&&a.createElement(O.j,{variant:"compact",vulnerabilities:e.vulnerabilities})):null)))):null))))),a.createElement(A.n,{idPrefix:"advisories-table",isTop:!1,isCompact:!0,paginationProps:ue}))),a.createElement(F.A,{isExpanded:t,uploads:D,handleUpload:B,handleRemoveUpload:G,extractSuccessMessage:e=>`${e.data.document_id} uploaded`,extractErrorMessage:e=>e.response?.data?e.message:"Error while uploading file",onCloseClick:()=>l(!1)}),"editLabels"===J&&X&&a.createElement(M.x,{resourceName:X.identifier,value:X.labels??{},onSave:e=>{((e,t)=>{ee({...e,labels:t})})(X,e),q(null),W(null)},onClose:()=>W(null)}),"viewSource"===J&&X&&a.createElement(b.a,{title:X?.identifier,isOpen:!0,onClose:()=>W(null),actions:[a.createElement(m.$n,{key:"cancel",variant:"link",onClick:()=>W(null)},"Close")]},X&&a.createElement(V.Z,{advisoryId:X.uuid})))}}}]);
//# sourceMappingURL=567.5ac65de1.min.js.map