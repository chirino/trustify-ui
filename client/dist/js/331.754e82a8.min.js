"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[331],{55399:(e,t,a)=>{a.d(t,{K:()=>i,S:()=>u});var r=a(44304),l=a(19174),n=a(53820),o=a(8742),s=a(53359);const i={none:{name:"None",shieldIconColor:r.p,progressProps:{variant:void 0}},low:{name:"Low",shieldIconColor:l.n,progressProps:{variant:void 0}},medium:{name:"Medium",shieldIconColor:n.H,progressProps:{variant:"warning"}},high:{name:"High",shieldIconColor:o.u,progressProps:{variant:"danger"}},critical:{name:"Critical",shieldIconColor:s.c,progressProps:{variant:"danger"}}},c=e=>{switch(e){case"low":return 1;case"medium":return 2;case"high":return 3;case"critical":return 4;default:return 0}};function u(e){return(t,a)=>c(e(t))-c(e(a))}},80863:(e,t,a)=>{a.d(t,{c:()=>h});var r=a(69935),l=a(34066),n=a(65753),o=a(24974),s=a(21639),i=a(3939),c=a(77635),u=a(92939),d=a(63696),m=a(49348),p=a(67837),y=a(52302),E=a(24417);const h=({advisoryId:e})=>{const{advisory:t,isFetching:a,fetchError:h}=(0,r.vy)(e);return d.createElement(E.a,{isFetching:a,fetchError:h},d.createElement(n.B,null,d.createElement(o.W,null,d.createElement(s.X,null,"Identifier"),d.createElement(i.d,null,d.createElement(c.$n,{variant:"link",isInline:!0,icon:d.createElement(u.Ay,null)},d.createElement(m.k2,{to:`/advisories/${t?.uuid}`},t?.identifier)))),d.createElement(o.W,null,d.createElement(s.X,null,"Severity"),d.createElement(i.d,null,t?.average_severity&&d.createElement(y.h,{value:t?.average_severity}))),d.createElement(o.W,null,d.createElement(s.X,null,"Title"),d.createElement(i.d,null,t?.title)),d.createElement(o.W,null,d.createElement(s.X,null,"Labels"),d.createElement(i.d,null,t?.labels&&d.createElement(p.g,{value:t?.labels}))),d.createElement(o.W,null,d.createElement(s.X,null,"Published"),d.createElement(i.d,null,(0,l.Yq)(t?.published))),d.createElement(o.W,null,d.createElement(s.X,null,"Modified"),d.createElement(i.d,null,(0,l.Yq)(t?.modified))),d.createElement(o.W,null,d.createElement(s.X,null,"Modified"),d.createElement(i.d,null,(0,l.Yq)(t?.withdrawn))),d.createElement(o.W,null,d.createElement(s.X,null,"Issuer"),d.createElement(i.d,null,t?.issuer?.name))))}},67837:(e,t,a)=>{a.d(t,{g:()=>s});var r=a(63696),l=a(23546),n=a(891),o=a(71743);const s=({value:e,defaultIsOpen:t})=>r.createElement(l.o,{isVertical:!0,defaultIsOpen:t,numLabels:2},Object.entries(e).sort((([e],[t])=>t.localeCompare(e))).map((([e,t],a)=>r.createElement(n.J,{key:a,color:"blue"},r.createElement(o.P,{content:`${e}=${t}`})))))},24417:(e,t,a)=>{a.d(t,{a:()=>s});var r=a(63696),l=a(59394),n=a(23338),o=a(75855);const s=e=>e.isFetching?r.createElement(l.a,null,r.createElement(n.y,null)):e.fetchError?r.createElement(o.q,null):e.children},52302:(e,t,a)=>{a.d(t,{h:()=>c});var r=a(63696),l=a(28338),n=a(70045),o=a(85310),s=a(93914),i=a(55399);const c=({value:e,hideLabel:t})=>{const a=i.K[e],c=e.charAt(0).toUpperCase()+e.slice(1);return r.createElement(l.s,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},r.createElement(n.Z,null,t?r.createElement(o.m,{content:c},r.createElement(s.Ay,{color:a.shieldIconColor.value})):r.createElement(s.Ay,{color:a.shieldIconColor.value})),!t&&r.createElement(n.Z,null,c))}},24808:(e,t,a)=>{a.d(t,{v:()=>i});var r=a(63696),l=a(64917),n=a(86820);const o="cancelled",s=(e,t)=>{switch(t.type){case"queueUpload":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},status:"queued",cancelFn:t.payload.cancelFn})};case"updateUploadProgress":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},progress:t.payload.progress||0,status:"inProgress"})};case"finishUploadSuccessfully":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file),status:"complete",response:t.payload.response})};case"finishUploadWithError":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file),status:"complete",error:t.payload.error,wasCancelled:t.payload.error?.message===o})};case"removeUpload":{const a=new Map(e.uploads);return a.delete(t.payload.file),{...e,uploads:a}}default:throw new Error}},i=({parallel:e,uploadFn:t,onSuccess:a,onError:i})=>{const[c,u]=r.useReducer(s,{uploads:new Map});return{uploads:c.uploads,handleUpload:r=>{const s=[];for(let e=0;e<r.length;e++){const t=r[e],c=new FormData;c.set(n.fs,t);const d=l.A.CancelToken.source(),m={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{const a=e.total??1,r=e.loaded/a*100;u({type:"updateUploadProgress",payload:{file:t,progress:Math.round(r)}})},cancelToken:d.token};u({type:"queueUpload",payload:{file:t,cancelFn:d}});const p={formData:c,config:m,thenFn:e=>{u({type:"finishUploadSuccessfully",payload:{file:t,response:e}}),a&&a(e,t)},catchFn:e=>{u({type:"finishUploadWithError",payload:{file:t,error:e}}),e.message!==o&&i&&i(e,t)}};s.push(p)}e?s.forEach((e=>{t(e.formData,e.config).then(e.thenFn).catch(e.catchFn)})):s.reduce((async(e,a)=>(await e,t(a.formData,a.config).then(a.thenFn).catch(a.catchFn))),Promise.resolve())},handleCancelUpload:e=>{c.uploads.get(e)?.cancelFn?.cancel(o)},handleRemoveUpload:e=>{u({type:"removeUpload",payload:{file:e}})}}}},40124:(e,t,a)=>{a.r(t),a.d(t,{default:()=>O});var r=a(63696),l=a(49348),n=a(68430),o=a(98261),s=a(75530),i=a(1180),c=a(72785),u=a(23665),d=a(70414),m=a(8210),p=a(2620),y=a(80876),E=a(17993),h=a(34066),v=a(20653),g=a(35048),f=a(4433),b=a(85578),P=a(16646),F=a(31065),I=a(77819),w=a(28516),T=a(3629),K=a(86820),C=a(33273),S=a(67837),q=a(1349),k=a(62520),x=a(70611),A=a(5098),M=a(91728);const _=({packageId:e})=>{const t=(0,x.MM)({tableName:"sboms",persistenceKeyPrefix:K.rt.sboms_by_package,columnNames:{name:"Name",published:"Published",labels:"Labels"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:C.RJ.search}]}),{result:{data:a,total:n},isFetching:o,fetchError:s}=(0,M.Qr)(e,(0,x.Ng)({...t,hubSortFieldKeys:{}})),i=(0,x.PB)({...t,idProperty:"id",currentPageItems:a,totalItemCount:n,isLoading:o,selectionState:(0,A.$)({items:a,isEqual:(e,t)=>e.id===t.id})}),{numRenderedColumns:c,currentPageItems:u,propHelpers:{toolbarProps:d,filterToolbarProps:m,paginationToolbarItemProps:p,paginationProps:y,tableProps:E,getThProps:_,getTrProps:L,getTdProps:U}}=i;return r.createElement(r.Fragment,null,r.createElement(v.M,{...d},r.createElement(g.P,null,r.createElement(C.Us,{showFiltersSideBySide:!0,...m}),r.createElement(f.T,{...p},r.createElement(q.n,{idPrefix:"sbom-table",isTop:!0,paginationProps:y})))),r.createElement(b.X,{...E,"aria-label":"SBOM table"},r.createElement(P.d,null,r.createElement(F.Tr,null,r.createElement(k.Ze,{...i},r.createElement(I.Th,{..._({columnKey:"name"})}),r.createElement(I.Th,{..._({columnKey:"published"})}),r.createElement(I.Th,{..._({columnKey:"labels"})})))),r.createElement(k.nJ,{isLoading:o,isError:!!s,isNoData:0===n,numRenderedColumns:c},u?.map((e=>r.createElement(w.N,{key:e.id},r.createElement(F.Tr,{...L({item:e})},r.createElement(T.Td,{width:35,...U({columnKey:"name"})},r.createElement(l.k2,{to:`/sboms/${e.id}`},e.name)),r.createElement(T.Td,{width:10,modifier:"truncate",...U({columnKey:"published"})},(0,h.Yq)(e.published)),r.createElement(T.Td,{width:35,modifier:"truncate",...U({columnKey:"labels"})},e.labels&&r.createElement(S.g,{value:e.labels})))))))),r.createElement(q.n,{idPrefix:"sboms-table",isTop:!1,isCompact:!0,paginationProps:y}))};var L=a(77635),U=a(891),N=a(28341),$=a(341),X=a(81230),J=a(80863),W=a(77307),R=a(52302),B=a(15311);const D=({packageId:e})=>{const[t,a]=r.useState(null),[n,o]=r.useState(null),{pkg:s,isFetching:c,fetchError:u}=(0,E.Si)(e),[d,m]=r.useState([]),[p,y]=r.useState(new Map),[h,K]=r.useState(!1),[S,A]=r.useState(new Set);r.useEffect((()=>{const e=(s?.advisories??[]).flatMap((e=>e.status.map((t=>({vulnerabilityId:t.vulnerability.identifier,status:t.status,context:{...t.context},advisory:{...e}}))))).reduce(((e,t)=>e.find((e=>e.vulnerabilityId===t.vulnerabilityId&&e.advisory.uuid===t.advisory.uuid))?e:[...e,t]),[]),t=new Set;e.forEach((e=>t.add(e.status))),m(e),A(t),K(!0),Promise.all(e.map((e=>(0,X.ld)(e.vulnerabilityId))).map((e=>e.catch((()=>null))))).then((e=>{const t=e.reduce(((e,t)=>t?[...e,t]:e),[]),a=new Map;t.forEach((e=>a.set(e.identifier,e))),y(a),K(!1)}))}),[s]);const M=r.useMemo((()=>d.map((e=>({...e,vulnerability:p.get(e.vulnerabilityId)})))),[d,p]),_=(0,B.f)(M,(e=>`${e.vulnerabilityId}-${e.advisory.identifier}-${e.advisory.uuid}`)),D=(0,x.vY)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:_,isLoading:!1,columnNames:{id:"ID",title:"Title",severity:"Severity",advisory:"Advisory",context:"Context",status:"Status"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["id"],getSortValues:e=>({id:e.vulnerabilityId}),isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter text",placeholderText:"Search",type:C.RJ.search,getItemValue:e=>e.vulnerabilityId},{categoryKey:"status",title:"Status",placeholderText:"Status",type:C.RJ.multiselect,selectOptions:Array.from(S).map((e=>({value:e,label:e.charAt(0).toUpperCase()+e.slice(1).replace("_"," ")}))),matcher:(e,t)=>t.status===e}],isExpansionEnabled:!1}),{currentPageItems:O,numRenderedColumns:Q,propHelpers:{toolbarProps:H,filterToolbarProps:j,paginationToolbarItemProps:V,paginationProps:Y,tableProps:Z,getThProps:z,getTrProps:G,getTdProps:ee},expansionDerivedState:{isCellExpanded:te}}=D;return r.createElement(r.Fragment,null,r.createElement(v.M,{...H},r.createElement(g.P,null,r.createElement(C.Us,{showFiltersSideBySide:!0,...j}),r.createElement(f.T,{...V},r.createElement(q.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:Y})))),r.createElement(b.X,{...Z,"aria-label":"vulnerability table"},r.createElement(P.d,null,r.createElement(F.Tr,null,r.createElement(k.Ze,{...D},r.createElement(I.Th,{...z({columnKey:"id"})}),r.createElement(I.Th,{...z({columnKey:"title"})}),r.createElement(I.Th,{...z({columnKey:"severity"})}),r.createElement(I.Th,{...z({columnKey:"advisory"})}),r.createElement(I.Th,{...z({columnKey:"context"})}),r.createElement(I.Th,{...z({columnKey:"status"})})))),r.createElement(k.nJ,{isLoading:c||h,isError:!!u,isNoData:0===_.length,numRenderedColumns:Q},O?.map(((e,t)=>r.createElement(w.N,{key:e._ui_unique_id,isExpanded:te(e)},r.createElement(F.Tr,{...G({item:e})},r.createElement(k.Oi,{...D,item:e,rowIndex:t},r.createElement(T.Td,{width:15,...ee({columnKey:"id"})},r.createElement(l.k2,{to:`/vulnerabilities/${e.vulnerabilityId}`},e.vulnerabilityId)),r.createElement(T.Td,{width:35,modifier:"truncate",...ee({columnKey:"title"})},e.vulnerability?.title),r.createElement(T.Td,{width:10,...ee({columnKey:"severity"})},e.vulnerability?.average_severity&&r.createElement(R.h,{value:e.vulnerability.average_severity})),r.createElement(T.Td,{width:15,modifier:"truncate",...ee({columnKey:"advisory"})},r.createElement(L.$n,{size:"sm",variant:L.Ak.secondary,onClick:()=>{return t=e,a("showAdvisory"),void o(t);var t}},e.advisory.identifier)),r.createElement(T.Td,{width:25,modifier:"truncate",...ee({columnKey:"context"})},e.context.cpe),r.createElement(T.Td,{width:10,modifier:"truncate",...ee({columnKey:"status"})},r.createElement(U.J,null,e.status.charAt(0).toUpperCase()+e.status.slice(1).replace("_"," ")))))))))),r.createElement(q.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:Y}),r.createElement(W.q,{isExpanded:null!==t,onCloseClick:()=>a(null),pageKey:"drawer",drawerPanelContentProps:{defaultSize:"600px"},header:r.createElement(r.Fragment,null,"showAdvisory"===t&&r.createElement(i.n,null,r.createElement(N.h,{headingLevel:"h2",size:"lg",className:$.A.mtXs},"Advisory")))},"showAdvisory"===t&&r.createElement(r.Fragment,null,n?.advisory&&r.createElement(J.c,{advisoryId:n?.advisory.uuid}))))},O=()=>{const e=(0,y.Lu)(y.vO.PACKAGE_ID),{pkg:t}=(0,E.Si)(e),a=r.useMemo((()=>t?(0,h.fe)(t.purl):void 0),[t]);return r.createElement(r.Fragment,null,r.createElement(n.d8,{variant:"light"},r.createElement(p.A,{breadcrumbs:r.createElement(o.Q,null,r.createElement(s.J,{key:"packages"},r.createElement(l.N_,{to:"/packages"},"Packages")),r.createElement(s.J,{isActive:!0},"Package details")),pageHeading:{title:a?.name??e??"",iconAfterTitle:t?r.createElement(i.n,null,r.createElement(c.E,{component:"pre"},`version: ${a?.version}`)):void 0,label:t?{children:t?`type=${a?.type}`:"",isCompact:!0}:void 0},actionButtons:[],tabs:[{eventKey:"vulnerabilities",title:"Vulnerabilities",children:r.createElement("div",{className:"pf-v5-u-m-md"},e&&r.createElement(D,{packageId:e})),actions:r.createElement(r.Fragment,null,r.createElement(u.A,{bodyContent:r.createElement("div",null,"Vulnerabilities ",r.createElement("strong",null,"associated")," to the current package."),position:"top"},r.createElement(d.o,null,r.createElement(m.Ay,null))))},{eventKey:"sboms",title:"SBOMs",children:r.createElement("div",{className:"pf-v5-u-m-md"},e&&r.createElement(_,{packageId:e})),actions:r.createElement(r.Fragment,null,r.createElement(u.A,{bodyContent:r.createElement("div",null,"SBOMs that ",r.createElement("strong",null,"contain")," the current package."),position:"top"},r.createElement(d.o,null,r.createElement(m.Ay,null))))}]})))}},69935:(e,t,a)=>{a.d(t,{VH:()=>c,Yu:()=>m,qF:()=>d,uJ:()=>p,vy:()=>u});var r=a(7616),l=a(3715),n=a(26667),o=a(81230),s=a(24808);const i="advisories",c=(e={},t=!1)=>{const{data:a,isLoading:l,error:n,refetch:s}=(0,r.I)({queryKey:[i,e],queryFn:()=>(0,o.uK)(e),refetchInterval:!t&&5e3});return{result:{data:a?.data||[],total:a?.total??0,params:a?.params??e},isFetching:l,fetchError:n,refetch:s}},u=e=>{const{data:t,isLoading:a,error:l}=(0,r.I)({queryKey:[i,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,o.wJ)(e),enabled:void 0!==e});return{advisory:t,isFetching:a,fetchError:l}},d=e=>{const{data:t,isLoading:a,error:l}=(0,r.I)({queryKey:[i,e,"source"],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,o.N2)(e),enabled:void 0!==e});return{source:t,isFetching:a,fetchError:l}},m=()=>{const e=(0,l.jE)();return(0,s.v)({parallel:!0,uploadFn:(e,t)=>(0,o.hP)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[i]})}})},p=(e,t)=>{const a=(0,l.jE)();return(0,n.n)({mutationFn:e=>(0,o._e)(e.uuid,e.labels??{}),onSuccess:(t,r)=>{e(),a.invalidateQueries({queryKey:[i]})},onError:t})}},17993:(e,t,a)=>{a.d(t,{Lx:()=>o,Si:()=>s,sl:()=>i});var r=a(7616),l=a(81230);const n="packages",o=(e={},t=!1)=>{const{data:a,isLoading:o,error:s,refetch:i}=(0,r.I)({queryKey:[n,e],queryFn:()=>(0,l.G9)(e),refetchInterval:!t&&5e3});return{result:{data:a?.data||[],total:a?.total??0,params:a?.params??e},isFetching:o,fetchError:s,refetch:i}},s=e=>{const{data:t,isLoading:a,error:o}=(0,r.I)({queryKey:[n,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,l.$f)(e)});return{pkg:t,isFetching:a,fetchError:o}},i=(e,t={})=>{const{data:a,isLoading:o,error:s,refetch:i}=(0,r.I)({queryKey:[n,"by-sbom",e,t],queryFn:()=>(0,l.$u)(e,t)});return{result:{data:a?.data||[],total:a?.total??0,params:a?.params??t},isFetching:o,fetchError:s,refetch:i}}},91728:(e,t,a)=>{a.d(t,{Qr:()=>p,cF:()=>m,i$:()=>c,rj:()=>u,sn:()=>d});var r=a(7616),l=a(3715),n=a(26667),o=a(81230),s=a(24808);const i="sboms",c=(e={},t=!1)=>{const{data:a,isLoading:l,error:n,refetch:s}=(0,r.I)({queryKey:[i,e],queryFn:()=>(0,o.ll)(e),refetchInterval:!t&&5e3});return{result:{data:a?.data||[],total:a?.total??0,params:a?.params??e},isFetching:l,fetchError:n,refetch:s}},u=e=>{const{data:t,isLoading:a,error:l}=(0,r.I)({queryKey:[i,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,o.Q6)(e),enabled:void 0!==e});return{sbom:t,isFetching:a,fetchError:l}},d=()=>{const e=(0,l.jE)();return(0,s.v)({parallel:!0,uploadFn:(e,t)=>(0,o.J4)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[i]})}})},m=(e,t)=>{const a=(0,l.jE)();return(0,n.n)({mutationFn:e=>(0,o.aB)(e.id,e.labels??{}),onSuccess:(t,r)=>{e(),a.invalidateQueries({queryKey:[i]})},onError:t})},p=(e,t={})=>{const{data:a,isLoading:l,error:n,refetch:s}=(0,r.I)({queryKey:[i,"by-package",e,t],queryFn:()=>(0,o.hr)(e,t)});return{result:{data:a?.data||[],total:a?.total??0,params:a?.params??t},isFetching:l,fetchError:n,refetch:s}}},15311:(e,t,a)=>{a.d(t,{f:()=>n});var r=a(63696),l=a(86820);const n=(e,t)=>(0,r.useMemo)((()=>e&&0!==e.length?e.map((e=>({...e,[l.FA]:t(e)}))):[]),[e,t])}}]);
//# sourceMappingURL=331.754e82a8.min.js.map